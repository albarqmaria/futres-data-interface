<div class="col-xs-12" ng-controller="QueryFormController as queryFormVm">

    <modal-dialog show='downloadModalShown' dialog-title='Download Results' height='300px' width='70%'>
        <div>
	<p>The download feature allows users to obtain all results of queries in a zipped, comma-separated value file.
        Currently, download results are made available only to research partners of the global plant phenology data portal.  
	We are now working with our data providers to assure all data usage agreements and conditions are met before offering public
	download.  
	<p></p>Enter your verification code in the box below in order to enable your download:
        </div>
        <div class="form form-horizontal">
            <div class="form-group">
                <div class="col-xs-3">
                        <dlabel class="control-label">Verification Code</label>
                </div>
                <div class="col-xs-3">
                        <input ng-model="queryFormVm.params.verifyDownload" type="text" class="form-control input-sm"/>
                </div>
                <div class="col-xs-3">
                        <button type="button" class="btn btn-primary" ng-show='true' ng-click="verify()">Verify</span></button>
                </div>
	    </div>
            <div ng-show='downloadButtonShown' class="form-group">
                <div class="col-xs-3">
                    <button type="button" class="btn btn-primary" ng-click="vm.downloadCsv()">Download</span></button>
                </div>
                <div class="col-xs-9">
    	        	<label class="hidden-xs information-text">
				Press download button to commence download.  Downloaded file may take up to 1 minute to process.  Larger numbers of results take longer to process.
			</label>
                </div>
	    </div>
        </div>
    </modal-dialog>

    <!-- format for help documentation for each field -->
    <modal-dialog id='traiter' show='modalShown' dialog-title='{{modalType}}' height='300px' width='70%'>
	    <p ng-bind-html="modalText"></p>	
    </modal-dialog>

    <form method="POST" name="queryForm" validate>
        <div class="form form-horizontal">
            <div class="form-group">
                <div class="col-xs-3">
                    <label class="control-label" >Traits</label>
  			<a><i class="remove glyphicon glyphicon-info-sign glyphicon-white" ng-click='toggleModal("Traits")'></i></a> 
                </div>

		<div class="col-xs-9">
                    <select ng-options="key as value for (value,key) in queryFormVm.traits"
                        ng-model="queryFormVm.params.traits"
                           class="form-control input-sm" required >
                        <option value="">-- Select Trait --</option>
                    </select>
                </div>	
                                <!--repeat="trait.value as (key, trait) in queryFormVm.traits | filter: {'key': $select.search} "-->
            </div>



            <div class="form-group">
                <div class="col-xs-3">
                    <label class="control-label">Genus</label>
  			<a><i class="remove glyphicon glyphicon-info-sign glyphicon-white" ng-click='toggleModal("Genus")'></i></a> 
                </div>
                <div class="col-xs-9">
                    <select ng-options="s for s in queryFormVm.genus"
                        ng-model="queryFormVm.params.genus"
                           class="form-control input-sm" required>
                        <option value="">-- Select Genus --</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <div class="col-xs-3">
                    <label class="control-label">Species</label>
                </div>
                <div class="col-xs-9">
                    <input ng-model="queryFormVm.params.specificEpithet" type="text"
                           class="form-control input-sm"/>
                </div>
            </div>

	    <!--
            <div class="form-group">
                <div class="col-xs-3">
                    <label class="control-label">Source</label>
                </div>
                <div class="col-xs-9">
                    <select ng-options="key as value for (value,key) in queryFormVm.dataSources"
                        ng-model="queryFormVm.params.source"
                           class="form-control input-sm" multiple>
                        <option value="">-- Select Source(s) --</option>
                    </select>
                </div>
            </div>
	    -->

            <div class="form-group">
                <div class="col-xs-3">
                    <label class="control-label">Year</label>
  			<a><i class="remove glyphicon glyphicon-info-sign glyphicon-white" ng-click='toggleModal("Year")'></i></a> 
                </div>
                <div class="col-xs-9">
		    <rzslider class="custom-slider" rz-slider-model="queryFormVm.params.fromYear"
          		rz-slider-high="queryFormVm.params.toYear"
          		rz-slider-options="queryFormVm.year.options"></rzslider>	
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-3">
                    <label class="control-label">Day of Year</label>
  			<a><i class="remove glyphicon glyphicon-info-sign glyphicon-white" ng-click='toggleModal("Day of Year")'></i></a> 
                </div>
                <div class="col-xs-9">
		    <rzslider class="custom-slider" rz-slider-model="queryFormVm.params.fromDay"
          		rz-slider-high="queryFormVm.params.toDay"
          		rz-slider-options="queryFormVm.day.options"></rzslider>	
                </div>
            </div>

        </div>
        <div class="form-group">
            <button type="submit" ng-click="queryFormVm.queryJson()" class="btn btn-primary" ><span class="glyphicon glyphicon-search"></span>Search</button>
            <!-- download menu -->
            <button type="submit" ng-click="toggleDownloadModal()" class="btn btn-success" ng-show="vm.queryResults.isSet && queryForm.$pristine">Download</button>
        </div>

</div>
        <div class="form-group">
			
            <!--<div class="col-xs-12">
	        <label class="label-warning">THIS SITE IS IN DEVELOPMENT!</label>
            </div>-->
            <div class="col-xs-12">
    	        <label class="hidden-xs information-text">
			<i>Field Data on plant phenology is made accessible here based on inputs from <a href='https://www.usanpn.org/' target='_blank'>NPN</a>, <a href='http://www.pep725.eu/' target='_blank'>PEP725</a>, and <a href='http://www.neonscience.org/' target='_blank'>NEON</a> partners. Incoming trait data is processed using the <a href='https://github.com/biocodellc/ppo-data-pipeline' target='_blank'>ppo-data-pipeline</a> with annotations from the <a href='https://github.com/PlantPhenoOntology/ppo' target='_blank'>plant phenology ontology</a> and phenological stage inferences processed using <a href='https://github.com/stuckyb/ontopilot' target='_blank'>ontopilot's</a> reasoner.</i>  
		    <p></p>
		    <i>NPN and NEON data was harvested on December 1, 2017 and will reflect the status of available data as of that data.  PEP725 data was harvested in May of 2017, reflecting data through February of 2017.  PEP725 provides yearly updates to their data store, so 2017 data will be made available in early 2018.  Currently, this portal contains 19 million records, with 10 million PEP725 records, 8.7 million NPN records, and 1.1 million NEON records.
		    <p></p>
		    <i>Funding support is from the USGS NSF-SAVI Award Number 1321595, the National Ecological Observatory Network, and the USGS Powell Center. Development of this site is ongoing and currently this page is in a Beta release stage, made available here for viewing and comment.  Comments can be made by email to jdeck88@gmail.com</i>

    	         </label>
	   </div>
    </form>
</div>
